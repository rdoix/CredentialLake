FROM nginx:alpine

# Install openssl for certificate generation
RUN apk add --no-cache openssl

# Copy nginx configuration
COPY nginx-ssl.conf /etc/nginx/conf.d/default.conf

# Copy certificate generation script
COPY generate-ssl-cert.sh /docker-entrypoint.d/10-generate-ssl-cert.sh
RUN chmod +x /docker-entrypoint.d/10-generate-ssl-cert.sh

EXPOSE 8443

CMD ["nginx", "-g", "daemon off;"]